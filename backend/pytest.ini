[pytest]
testpaths = tests
pythonpath = src
python_files = test_*.py
python_classes = Test*
python_functions = test_*
env = 
    USE_MOCK_CELERY = true
addopts = 
    -v
    --tb=short
    --strict-config
    --maxfail=5
    --no-header
    --ignore=tests/skip
    --ignore=tests/temp_debug
    --ignore=tests/e2e/skip
    --ignore=tests/integration/skip
    --ignore=tests/unit/skip
    --ignore=tests/unit/fastapi_yfinance/test_fastapi_yfinance.py
    --ignore=tests/unit/presentation/api/v1/test_market_api_simple.py
    --ignore=tests/integration/infrastructure/persistence/test_investment_repository_integration.py
    --ignore=tests/unit/infrastructure/persistence/models/test_market_data_cache.py
    --ignore=tests/e2e/test_user_scenarios.py
    --ignore=tests/unit/application/services/test_recommendation_service_extended.py
    --ignore=tests/unit/application/services/test_market_data_cache_service_complete.py
    --ignore=tests/unit/infrastructure/persistence/repositories/test_market_data_repository.py
    --ignore=tests/unit/application/services/test_recommendation_service.py
    --ignore=tests/unit/application/services/test_archive_recommendation_service_complete.py
    --ignore=tests/unit/application/services/test_advanced_analysis_service.py
    --ignore=tests/unit/infrastructure/persistence/repositories/test_portfolio_repository.py
    --ignore=tests/unit/application/services/test_risk_assessment_coverage.py
    --ignore=tests/unit/application/services/archiving/test_market_archiver.py
    --ignore=tests/unit/domain/repositories/test_market_data_timeline_repository_simple.py
    --ignore=tests/unit/application/services/test_risk_assessment.py

markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    unit: marks tests as unit tests
    fast: marks tests as fast running tests
    archiving: marks tests as archiving tests
    risk: marks tests as risk assessment tests
    performance: marks tests as performance tests
    e2e: marks tests as end-to-end tests
    database: marks tests as database tests
    intelligence: marks tests as intelligence tests
    cache: marks tests as cache tests

filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::sqlalchemy.exc.MovedIn20Warning
    ignore::sqlalchemy.exc.SAWarning
    ignore::RuntimeWarning
    ignore:.*event loop.*:DeprecationWarning
